import React, { useState, useEffect } from 'react';

// Tailwind CSS is assumed to be configured in a modern React project
// You'll also need lucide-react for the icons. You can install it with:
// npm install lucide-react

import {
  ChevronDown, ChevronUp, CheckCircle2, XCircle, SkipForward, ArrowLeft, ArrowRight, Flag, RefreshCw, Play, Pause
} from 'lucide-react';

// The question pool has been moved inside the component for simplicity
const questionsPool = [
  // --- Domain 1.0: General Security Concepts ---
  {
    id: 'q1-1',
    domain: '1.0 General Security Concepts',
    question: "What is the primary purpose of a compensating control?",
    options: ["To prevent an incident from occurring.", "To recover from an incident.", "To provide an alternative to a primary control that is not feasible.", "To deter potential attackers."],
    correctAnswers: ["To provide an alternative to a primary control that is not feasible."],
    difficulty: "Easy",
    hint: "Think about a situation where you can't implement the ideal security measure. What do you do instead?"
  },
  {
    id: 'q1-2',
    domain: '1.0 General Security Concepts',
    question: "Which of the following describes the 'Integrity' principle of the CIA triad?",
    options: ["Ensuring data is accessible to authorized users when needed.", "Ensuring data is not altered or destroyed in an unauthorized manner.", "Ensuring data is not disclosed to unauthorized individuals.", "Ensuring the identity of a user is verified before access is granted."],
    correctAnswers: ["Ensuring data is not altered or destroyed in an unauthorized manner."],
    difficulty: "Easy",
    hint: "Integrity is about keeping things the way they should be. It's about protecting against unauthorized modification or deletion."
  },
  {
    id: 'q1-3',
    domain: '1.0 General Security Concepts',
    question: "A company implements a policy that all employees must use a different password for each application. Which security principle does this best represent?",
    options: ["Least Privilege", "Defense in Depth", "Separation of Duties", "Non-repudiation"],
    correctAnswers: ["Defense in Depth"],
    difficulty: "Medium",
    hint: "This policy creates multiple layers of security. If one password is compromised, others are still safe. This is a key concept for building a robust security posture."
  },
  {
    id: 'q1-4',
    domain: '1.0 General Security Concepts',
    question: "In a physical security context, a fence around a data center is an example of what type of control?",
    options: ["Administrative", "Technical", "Compensating", "Physical"],
    correctAnswers: ["Physical"],
    difficulty: "Easy",
    hint: "This is a straightforward one. A fence is a tangible object that physically restricts access."
  },
  {
    id: 'q1-5',
    domain: '1.0 General Security Concepts',
    question: "Which of the following is the best example of a deterrent control?",
    options: ["A firewall blocking malicious traffic.", "An alarm system notifying security of a breach.", "A security awareness training program.", "A CCTV camera with a sign that says 'Smile, you're on camera.'"],
    correctAnswers: ["A CCTV camera with a sign that says 'Smile, you're on camera.'"],
    difficulty: "Medium",
    hint: "Deterrent controls are designed to discourage an attacker before they even attempt an action. It's about making them think twice."
  },
  // --- Domain 2.0: Threats, Vulnerabilities, and Mitigations ---
  {
    id: 'q2-1',
    domain: '2.0 Threats, Vulnerabilities, and Mitigations',
    question: "A user receives an email with an attachment that, when opened, encrypts all their files and demands a ransom. This is an example of what type of malware?",
    options: ["Trojan Horse", "Worm", "Ransomware", "Spyware"],
    correctAnswers: ["Ransomware"],
    difficulty: "Easy",
    hint: "The name of this type of malware literally describes what it does: it holds your data for ransom."
  },
  {
    id: 'q2-2',
    domain: '2.0 Threats, Vulnerabilities, and Mitigations',
    question: "What is the primary difference between a vulnerability and an exploit?",
    options: ["A vulnerability is a weakness, while an exploit is the method used to take advantage of it.", "A vulnerability is a piece of malware, while an exploit is a type of virus.", "A vulnerability is a software bug, while an exploit is a hardware failure.", "A vulnerability is a threat, while an exploit is a risk."],
    correctAnswers: ["A vulnerability is a weakness, while an exploit is the method used to take advantage of it."],
    difficulty: "Medium",
    hint: "A vulnerability is a *potential* problem, a flaw in the system. An exploit is the *action* taken to make that flaw an actual problem."
  },
  {
    id: 'q2-3',
    domain: '2.0 Threats, Vulnerabilities, and Mitigations',
    question: "An attacker sends a flood of traffic from a large number of compromised computers to a single server to take it offline. What kind of attack is this?",
    options: ["Man-in-the-Middle (MitM)", "Phishing", "Distributed Denial-of-Service (DDoS)", "Cross-site Scripting (XSS)"],
    correctAnswers: ["Distributed Denial-of-Service (DDoS)"],
    difficulty: "Easy",
    hint: "The key term here is 'flood of traffic from a large number of compromised computers'. This makes it 'distributed'."
  },
  {
    id: 'q2-4',
    domain: '2.0 Threats, Vulnerabilities, and Mitigations',
    question: "Which of the following is a common mitigation technique for a buffer overflow attack?",
    options: ["Implementing a strong firewall.", "Using input validation and bounds checking.", "Enforcing a strong password policy.", "Encrypting all network traffic."],
    correctAnswers: ["Using input validation and bounds checking."],
    difficulty: "Hard",
    hint: "A buffer overflow happens when an application tries to write data past the end of a fixed-size buffer. The solution is to ensure the input isn't larger than the buffer's capacity."
  },
  {
    id: 'q2-5',
    domain: '2.0 Threats, Vulnerabilities, and Mitigations',
    question: "A user is tricked into revealing sensitive information by an attacker pretending to be a legitimate IT support person. This is a classic example of what social engineering technique?",
    options: ["Phishing", "Vishing", "Pretexting", "Tailgating"],
    correctAnswers: ["Pretexting"],
    difficulty: "Medium",
    hint: "Pretexting involves creating a fictional scenario or a 'pretext' to manipulate someone into giving up information. The attacker has a story."
  },
  // --- Domain 3.0: Secure Architecture and Design ---
  {
    id: 'q3-1',
    domain: '3.0 Secure Architecture and Design',
    question: "Which of the following best describes the purpose of network segmentation?",
    options: ["To increase network speed.", "To separate different network zones to limit the scope of a breach.", "To provide a backup network in case of failure.", "To connect a LAN to a WAN."],
    correctAnswers: ["To separate different network zones to limit the scope of a breach."],
    difficulty: "Medium",
    hint: "Think of it like watertight compartments on a ship. If one compartment floods, it doesn't sink the whole ship."
  },
  {
    id: 'q3-2',
    domain: '3.0 Secure Architecture and Design',
    question: "What is the primary function of a Security Information and Event Management (SIEM) system?",
    options: ["To prevent malware from entering the network.", "To encrypt data at rest and in transit.", "To centralize and analyze security alerts and log data.", "To manage user identities and access control."],
    correctAnswers: ["To centralize and analyze security alerts and log data."],
    difficulty: "Hard",
    hint: "The 'E' in SIEM stands for 'Event'. A SIEM's main job is to collect and correlate all the security-related events from various sources."
  },
  {
    id: 'q3-3',
    domain: '3.0 Secure Architecture and Design',
    question: "Which architectural design principle involves the use of multiple vendors for similar security controls to prevent a single point of failure?",
    options: ["Least Privilege", "Fail-safe", "Vendor Diversity", "Defense in Depth"],
    correctAnswers: ["Vendor Diversity"],
    difficulty: "Medium",
    hint: "The answer is in the question! Using different vendors for different parts of your security stack is the definition of this principle."
  },
  {
    id: 'q3-4',
    domain: '3.0 Secure Architecture and Design',
    question: "What is the purpose of a honey pot?",
    options: ["To provide a secure environment for sensitive data.", "To attract and trap attackers to learn about their methods.", "To encrypt and protect network traffic.", "To filter malicious emails before they reach the user."],
    correctAnswers: ["To attract and trap attackers to learn about their methods."],
    difficulty: "Medium",
    hint: "Just like its name, a honey pot is a sweet, tempting target designed to lure in attackers so you can observe them."
  },
  {
    id: 'q3-5',
    domain: '3.0 Secure Architecture and Design',
    question: "Which of the following is the best way to secure an application's database connection string?",
    options: ["Store it in a configuration file on the web server.", "Hard-code it directly into the application source code.", "Use a secure secrets management system.", "Encrypt the database but store the key with the connection string."],
    correctAnswers: ["Use a secure secrets management system."],
    difficulty: "Hard",
    hint: "Storing secrets in plain text or hard-coding them is a major security risk. A secrets management system (like Vault or Azure Key Vault) is the industry standard for this."
  },
  // --- Domain 4.0: Secure Operations and Incident Response ---
  {
    id: 'q4-1',
    domain: '4.0 Secure Operations and Incident Response',
    question: "What is the first phase of the incident response process?",
    options: ["Containment", "Eradication", "Preparation", "Recovery"],
    correctAnswers: ["Preparation"],
    difficulty: "Medium",
    hint: "Before an incident even happens, you need to have a plan in place. This is the foundation of a successful response."
  },
  {
    id: 'q4-2',
    domain: '4.0 Secure Operations and Incident Response',
    question: "Which of the following is an example of an 'Eradication' activity in incident response?",
    options: ["Taking an infected system offline.", "Patching the vulnerability that was exploited.", "Restoring data from a known good backup.", "Notifying all affected parties of the breach."],
    correctAnswers: ["Patching the vulnerability that was exploited."],
    difficulty: "Hard",
    hint: "Eradication is about getting rid of the root cause of the incident. It's not just about stopping the immediate problem (containment), but about eliminating the source."
  },
  {
    id: 'q4-3',
    domain: '4.0 Secure Operations and Incident Response',
    question: "The process of collecting, processing, and analyzing digital evidence in a way that is legally admissible is known as what?",
    options: ["Vulnerability Scanning", "Penetration Testing", "Digital Forensics", "Risk Management"],
    correctAnswers: ["Digital Forensics"],
    difficulty: "Easy",
    hint: "Think about crime scene investigation, but for computers. The goal is to collect evidence without contaminating it."
  },
  {
    id: 'q4-4',
    domain: '4.0 Secure Operations and Incident Response',
    question: "What is the primary goal of a Business Continuity Plan (BCP)?",
    options: ["To recover from a disaster as quickly as possible.", "To ensure critical business functions continue during a disruption.", "To identify and mitigate all potential risks.", "To manage and respond to a security incident."],
    correctAnswers: ["To ensure critical business functions continue during a disruption."],
    difficulty: "Medium",
    hint: "A BCP is not just about recovery (that's the DRP). It's about keeping the business running, even if in a degraded state, when something bad happens."
  },
  {
    id: 'q4-5',
    domain: '4.0 Secure Operations and Incident Response',
    question: "Which of the following is a key component of a Disaster Recovery Plan (DRP)?",
    options: ["A list of all employees and their contact information.", "Procedures for restoring IT infrastructure after a major outage.", "A plan for handling media inquiries after a breach.", "A policy for acceptable use of company assets."],
    correctAnswers: ["Procedures for restoring IT infrastructure after a major outage."],
    difficulty: "Easy",
    hint: "A DRP is specifically about 'Disaster Recovery'. Its focus is on getting the technology back online after a major event."
  },
  // --- Domain 5.0: Governance, Risk, and Compliance ---
  {
    id: 'q5-1',
    domain: '5.0 Governance, Risk, and Compliance',
    question: "What is the purpose of a Risk Register?",
    options: ["To list all the assets in an organization.", "To track all known threats and vulnerabilities.", "To document and track identified risks, their severity, and mitigation plans.", "To store all security policies and procedures."],
    correctAnswers: ["To document and track identified risks, their severity, and mitigation plans."],
    difficulty: "Medium",
    hint: "A register is a record. In this case, it's a record of all the risks your organization faces, along with what you plan to do about them."
  },
  {
    id: 'q5-2',
    domain: '5.0 Governance, Risk, and Compliance',
    question: "Which of the following is an example of an 'Administrative' control?",
    options: ["A firewall.", "An Intrusion Detection System (IDS).", "A security policy.", "A biometric scanner."],
    correctAnswers: ["A security policy."],
    difficulty: "Easy",
    hint: "Administrative controls are policies, procedures, and guidelines that dictate how people should behave. They are not technical systems."
  },
  {
    id: 'q5-3',
    domain: '5.0 Governance, Risk, and Compliance',
    question: "What is the main goal of a Service Level Agreement (SLA)?",
    options: ["To define the security policies for an organization.", "To specify the level of service a provider is expected to deliver.", "To list all the hardware and software used in a system.", "To document the roles and responsibilities of the security team."],
    correctAnswers: ["To specify the level of service a provider is expected to deliver."],
    difficulty: "Easy",
    hint: "The name says it all. It's an 'Agreement' about the 'Service Level'."
  },
  {
    id: 'q5-4',
    domain: '5.0 Governance, Risk, and Compliance',
    question: "Which risk management strategy involves accepting a risk because the cost of mitigating it is higher than the potential loss?",
    options: ["Risk Acceptance", "Risk Avoidance", "Risk Transference", "Risk Mitigation"],
    correctAnswers: ["Risk Acceptance"],
    difficulty: "Easy",
    hint: "If you decide to 'live with' a risk, you are accepting it."
  },
  {
    id: 'q5-5',
    domain: '5.0 Governance, Risk, and Compliance',
    question: "Which of the following is a key objective of a Business Impact Analysis (BIA)?",
    options: ["To determine the maximum acceptable downtime for business processes.", "To identify all potential threats to an organization.", "To test the effectiveness of a disaster recovery plan.", "To create a list of all company assets."],
    correctAnswers: ["To determine the maximum acceptable downtime for business processes."],
    difficulty: "Hard",
    hint: "A BIA is about understanding the impact of a disruption. A crucial part of that is figuring out how long you can afford to be down before the impact becomes unacceptable."
  },
];


// Main application component
export default function App() {
  const [examStarted, setExamStarted] = useState(false);
  const [currentQuestionIndex, setCurrentQuestionIndex] = useState(0);
  const [userAnswers, setUserAnswers] = useState({});
  const [isPaused, setIsPaused] = useState(false);
  const [timeRemaining, setTimeRemaining] = useState(75 * 60); // 75 minutes in seconds
  const [shuffledQuestions, setShuffledQuestions] = useState([]);
  const [flaggedQuestions, setFlaggedQuestions] = useState({});
  const [showResults, setShowResults] = useState(false);
  const [score, setScore] = useState(0);
  // New state to manage the visibility of hints
  const [openHints, setOpenHints] = useState({});

  useEffect(() => {
    let timer;
    if (examStarted && !isPaused && timeRemaining > 0) {
      timer = setInterval(() => {
        setTimeRemaining(prevTime => prevTime - 1);
      }, 1000);
    }
    if (timeRemaining === 0) {
      handleExamCompletion();
    }
    return () => clearInterval(timer);
  }, [examStarted, isPaused, timeRemaining]);

  const startNewExam = () => {
    // Shuffle the question pool and select 10 questions
    const shuffledPool = [...questionsPool].sort(() => 0.5 - Math.random());
    setShuffledQuestions(shuffledPool.slice(0, 10)); // Select 10 for a mini-exam
    setExamStarted(true);
    setCurrentQuestionIndex(0);
    setUserAnswers({});
    setIsPaused(false);
    setTimeRemaining(75 * 60);
    setFlaggedQuestions({});
    setShowResults(false);
    setScore(0);
    setOpenHints({});
  };

  const handleAnswerChange = (questionId, option) => {
    setUserAnswers(prevAnswers => ({
      ...prevAnswers,
      [questionId]: option,
    }));
  };

  const goToNextQuestion = () => {
    if (currentQuestionIndex < shuffledQuestions.length - 1) {
      setCurrentQuestionIndex(prevIndex => prevIndex + 1);
    }
  };

  const goToPreviousQuestion = () => {
    if (currentQuestionIndex > 0) {
      setCurrentQuestionIndex(prevIndex => prevIndex - 1);
    }
  };

  const handleFlagQuestion = (questionId) => {
    setFlaggedQuestions(prevFlags => ({
      ...prevFlags,
      [questionId]: !prevFlags[questionId],
    }));
  };

  const handleExamCompletion = () => {
    let finalScore = 0;
    shuffledQuestions.forEach(q => {
      if (userAnswers[q.id] === q.correctAnswers[0]) {
        finalScore += 1;
      }
    });
    setScore(finalScore);
    setShowResults(true);
    setExamStarted(false);
  };

  const formatTime = (seconds) => {
    const minutes = Math.floor(seconds / 60);
    const remainingSeconds = seconds % 60;
    return `${minutes}:${remainingSeconds < 10 ? '0' : ''}${remainingSeconds}`;
  };

  const toggleHint = (questionId) => {
    setOpenHints(prevHints => ({
      ...prevHints,
      [questionId]: !prevHints[questionId],
    }));
  };

  if (showResults) {
    return (
      <div className="flex flex-col items-center justify-center min-h-screen bg-gray-900 text-gray-200 p-8 rounded-lg shadow-xl">
        <h1 className="text-4xl font-extrabold text-blue-400 mb-4 text-center">
          Exam Results
        </h1>
        <p className="text-2xl mb-6">
          You scored <span className="text-green-400 font-bold">{score}</span> out of <span className="text-blue-400 font-bold">{shuffledQuestions.length}</span>.
        </p>
        <div className="w-full max-w-2xl mt-8">
          <h2 className="text-2xl font-bold mb-4">Review Your Answers</h2>
          {shuffledQuestions.map((q, index) => {
            const userAnswer = userAnswers[q.id];
            const isCorrect = userAnswer === q.correctAnswers[0];
            return (
              <div key={q.id} className="mb-6 p-4 rounded-lg shadow-md transition-colors duration-200" style={{ backgroundColor: isCorrect ? 'rgba(34, 197, 94, 0.1)' : 'rgba(239, 68, 68, 0.1)' }}>
                <div className="flex items-start space-x-3 mb-2">
                  {isCorrect ? (
                    <CheckCircle2 className="text-green-500 flex-shrink-0 mt-1" size={24} />
                  ) : (
                    <XCircle className="text-red-500 flex-shrink-0 mt-1" size={24} />
                  )}
                  <p className="text-lg font-semibold">{index + 1}. {q.question}</p>
                </div>
                <p className="ml-9 text-md">Your answer: <span className="font-medium">{userAnswer || 'Not answered'}</span></p>
                {!isCorrect && (
                  <p className="ml-9 text-md text-green-400">Correct answer: <span className="font-medium">{q.correctAnswers[0]}</span></p>
                )}
                {/* Optional: Show hint on review page */}
                {q.hint && (
                  <div className="mt-2 ml-9 text-sm text-gray-400 p-2 rounded-md border border-gray-700">
                    <p className="font-bold">Hint:</p>
                    <p>{q.hint}</p>
                  </div>
                )}
              </div>
            );
          })}
        </div>
        <button
          onClick={startNewExam}
          className="mt-8 p-4 rounded-lg bg-blue-600 text-white text-xl font-bold hover:bg-blue-700 transition-colors duration-200"
        >
          Take Another Exam
        </button>
      </div>
    );
  }

  if (isPaused) {
    return (
      <div className="flex flex-col items-center justify-center min-h-[400px] bg-gray-900 text-gray-200 p-8 rounded-lg shadow-xl">
        <h1 className="text-4xl font-extrabold text-blue-400 mb-4 text-center">
          Exam Paused
        </h1>
        <p className="text-lg text-center mb-6 max-w-md">
          Your exam timer has been paused. You have {formatTime(timeRemaining)} remaining.
        </p>
        <button
          onClick={() => setIsPaused(false)}
          className="p-4 rounded-lg bg-green-600 text-white text-xl font-bold hover:bg-green-700 transition-colors duration-200 flex items-center space-x-2"
        >
          <Play size={24} />
          <span>Resume Exam</span>
        </button>
      </div>
    );
  }

  if (!examStarted) {
    return (
      <div className="flex flex-col items-center justify-center min-h-[400px] bg-gray-900 text-gray-200 p-8 rounded-lg shadow-xl">
        <h1 className="text-4xl font-extrabold text-blue-400 mb-4 text-center">
          CompTIA Security+ SY0-701 Practice Exam
        </h1>
        <p className="text-lg text-center mb-6 max-w-md">
          This practice exam consists of 10 questions pulled from a pool of 20,
          covering all the key objectives for the SY0-701 certification. You will have 75 minutes to complete the test.
        </p>
        <button
          onClick={startNewExam}
          className="p-4 rounded-lg bg-green-600 text-white text-xl font-bold hover:bg-green-700 transition-colors duration-200"
        >
          Start Exam
        </button>
      </div>
    );
  }

  const currentQuestion = shuffledQuestions[currentQuestionIndex];

  return (
    <div className="p-4 sm:p-8 bg-gray-950 text-gray-100 min-h-screen font-sans">
      {/* Header and Controls */}
      <div className="flex flex-col sm:flex-row items-center justify-between mb-6 p-4 bg-gray-800 rounded-lg shadow-lg">
        <h1 className="text-2xl font-extrabold text-blue-400 mb-2 sm:mb-0">
          CompTIA Security+ Exam
        </h1>
        <div className="flex items-center space-x-4">
          <div className="text-lg font-bold">
            Time Remaining: <span className="text-yellow-400">{formatTime(timeRemaining)}</span>
          </div>
          <button
            onClick={() => setIsPaused(true)}
            className="p-2 rounded-full bg-red-600 text-white hover:bg-red-700 transition-colors duration-200"
            title="Pause Exam"
          >
            <Pause size={20} />
          </button>
          <button
            onClick={() => handleFlagQuestion(currentQuestion.id)}
            className={`p-2 rounded-full transition-colors duration-200 ${flaggedQuestions[currentQuestion.id] ? 'bg-yellow-500 text-gray-900 hover:bg-yellow-600' : 'bg-gray-600 text-gray-200 hover:bg-gray-500'}`}
            title="Flag for Review"
          >
            <Flag size={20} />
          </button>
        </div>
      </div>

      {/* Question and Options Section */}
      <div className="flex-grow bg-gray-900 p-6 rounded-lg shadow-2xl">
        <div className="flex justify-between items-center mb-4">
          <h2 className="text-xl font-bold">
            Question {currentQuestionIndex + 1} of {shuffledQuestions.length}
          </h2>
          <span className="text-sm text-gray-400">
            Domain: {currentQuestion.domain}
          </span>
        </div>
        
        {/* Question Text */}
        <p className="text-xl leading-relaxed mb-6">
          {currentQuestion.question}
        </p>

        {/* New: Hint Dropdown */}
        {currentQuestion.hint && (
          <div className="mb-6">
            <button
              onClick={() => toggleHint(currentQuestion.id)}
              className="flex items-center space-x-2 text-blue-400 hover:text-blue-300 font-medium transition-colors duration-200"
            >
              {openHints[currentQuestion.id] ? (
                <ChevronUp size={20} />
              ) : (
                <ChevronDown size={20} />
              )}
              <span>{openHints[currentQuestion.id] ? 'Hide Hint' : 'Show Hint'}</span>
            </button>
            <div
              className={`mt-2 overflow-hidden transition-all duration-300 ease-in-out ${
                openHints[currentQuestion.id] ? 'max-h-40 opacity-100' : 'max-h-0 opacity-0'
              }`}
            >
              <div className="p-4 bg-gray-800 rounded-lg text-gray-300 shadow-inner">
                {currentQuestion.hint}
              </div>
            </div>
          </div>
        )}

        {/* Options List */}
        <div className="space-y-4">
          {currentQuestion.options.map(option => (
            <button
              key={option}
              onClick={() => handleAnswerChange(currentQuestion.id, option)}
              className={`w-full text-left p-4 rounded-lg border-2 transition-all duration-200 ${
                userAnswers[currentQuestion.id] === option
                  ? 'bg-blue-600 border-blue-400 text-white shadow-lg'
                  : 'bg-gray-800 border-gray-700 text-gray-200 hover:bg-gray-700 hover:border-blue-500'
              }`}
            >
              {option}
            </button>
          ))}
        </div>
      </div>

      {/* Navigation and Completion Buttons */}
      <div className="flex flex-col sm:flex-row justify-between items-center mt-6 space-y-4 sm:space-y-0 sm:space-x-4">
        <button
          onClick={goToPreviousQuestion}
          disabled={currentQuestionIndex === 0}
          className="p-3 sm:p-4 rounded-lg bg-gray-700 text-gray-200 font-bold hover:bg-gray-600 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2 w-full sm:w-auto justify-center"
        >
          <ArrowLeft size={20} />
          <span>Previous</span>
        </button>
        {currentQuestionIndex === shuffledQuestions.length - 1 ? (
          <button
            onClick={handleExamCompletion}
            className="p-3 sm:p-4 rounded-lg bg-green-600 text-white font-bold hover:bg-green-700 transition-colors duration-200 w-full sm:w-auto"
          >
            Finish Exam
          </button>
        ) : (
          <button
            onClick={goToNextQuestion}
            className="p-3 sm:p-4 rounded-lg bg-blue-600 text-white font-bold hover:bg-blue-700 transition-colors duration-200 w-full sm:w-auto flex items-center space-x-2 justify-center"
          >
            <span>Next</span>
            <ArrowRight size={20} />
          </button>
        )}
      </div>

      {/* Flagged questions quick nav (optional, but useful) */}
      <div className="mt-8 p-4 bg-gray-800 rounded-lg shadow-lg">
        <h3 className="text-xl font-bold mb-2 text-blue-300">Question Navigation</h3>
        <div className="flex flex-wrap gap-2">
          {shuffledQuestions.map((q, index) => (
            <button
              key={q.id}
              onClick={() => setCurrentQuestionIndex(index)}
              className={`p-2 w-10 h-10 rounded-lg font-bold transition-all duration-200 ${
                currentQuestionIndex === index
                  ? 'bg-blue-600 text-white scale-110'
                  : flaggedQuestions[q.id]
                  ? 'bg-yellow-500 text-gray-900 hover:bg-yellow-600'
                  : 'bg-gray-700 text-gray-300 hover:bg-gray-600'
              }`}
            >
              {index + 1}
            </button>
          ))}
        </div>
      </div>
    </div>
  );
}
